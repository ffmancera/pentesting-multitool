#! /usr/bin/env python3

import argparse, sys
from utility_scripts import dns_utility, whois_utility, shodan_utility, bannergrab_utility, flooder_utility, fuzzing_utility, mitm_utility

def main():

    parser = argparse.ArgumentParser(description='Pentesting-Multitool project arises from the need to gather some pentesting tools into one tool.'
                                                 ' It will be developed using Python3 adding some external libraries as DNSPython, pythonwhois or scapy.')

    # Argument for DNS function

    parser.add_argument('-DNS', metavar='--DNS', type=str, help='Using it you can get information about a DNS record of a specific domain.\n'
                        'Usage: <domain> -r <record> options: <-f --file>')

    # Argument for whois function

    parser.add_argument('-whois', metavar='--whois', type=str, help='Using it you can get information about a domain. '
                                                                    'Usage: whois <domain> options: <-f --file>.')

    # Optionals

    parser.add_argument('-r', metavar='--record', required='-DNS' in sys.argv or '--DNS' in sys.argv, type=str, help='Record of a specific domain.')

    parser.add_argument('-f', metavar='--file',type=str, help='Filename where you want to save the result.')

    #Defining args

    args = parser.parse_args()

    #Calls
    if args.DNS is not None:
        dns_utility.dns_scan(args.DNS, args.r, args.f)
    elif args.whois is not None:
        whois_utility.whois_scan(args.whois, args.f)

if __name__ == '__main__':
    main()
