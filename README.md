# Pentesting-Multitool
## Introduction

Pentesting-Multitool project arises from the need to gather some pentesting tools into one tool. It will be developed using Python3 adding some external libraries as DNSPython, pythonwhois or scapy. 

The main functions of the script is to collect information about the DNS records, domain or other devices.

## Necessary settings before use it

Before using pentesting-multitool.py please follow these steps:  

1.- Install **python3**, the script has been developed using python3.5.2 but I think that python3.x should work correctly, if not, please report it.  
2.- Install python module **dnspython-1.15.0**, you can check it from the [official website](http://www.dnspython.org/) or [official GitHub repository](https://github.com/rthalley/dnspython) If you can use the library with another version, please report it.  
3.- Install python module **pythonwhois-2.4.3**, you can download it from the [offical website](https://pypi.python.org/pypi/whois). If you can use the library with another version, please report it.  
4.- Install python module **shodan**, you can check it from the [official GitHub repository](https://github.com/achillean/shodan-python).  
5.- Install python module **scapy** for python3, you can download it from the [official website](http://secdev.org/projects/scapy/).  
6.- Install **TCPReplay** you can download it from the [official website](http://tcpreplay.appneta.com/).  

Well, now you are ready to use the script, so enjoy it!

## DNS record query

**Warning**: _Not all DNS records are implemented so check on this table what DNS records are available._

| RECORDS | STATUS |
|:-------:|:------:|
|    A    | Active |
|   AAAA  | Active |
|    MX   | Active |
|    NS   | Active |
|   TXT   | Active |
|   SOA   | Active |

* Note: I know that there are a lot of records but I won't test all, also you can check it on the [official documentation](http://www.dnspython.org/docs/1.15.0/) of DNSpython.

## Whois function

The whois function generates a dictionary with the information but I recommend to check the availability of the keys for the specified domain, anyway if the key isn't available an error message will be shown.  

Sometimes the information is hidden so keep that possibility in mind.

## Shodan search function

The Shodan search function (ssearch) uses the Shodan external library in order to integrate Shodan browser in our script.

The script implements a "simple search"(is simple as you want), for the search query parameters we will put exactly the same that if we were searching using Shodan website but with the filters separated by "-" here is an example of search query: 

```"ip:8.8.8.0/24-ports:22"```

## Banner grabbing function

The banner grabbing function first creates a socket with the specified IP and port, so we can use a list of ports (separated by `:`).

**Warning**: _Not all services are implemented so check on this table what service is available._

| SERVICE | STATUS |
|:-------:|:------:|
|   SSH   | ACTIVE |
|   FTP   | ACTIVE |
|   SMTP  | ACTIVE |
| MARIADB | ACTIVE |

* Note: Please, if you use it with other services and it does work, report it.

## Flooding using PCAP function

The flooding function have two options. The first option is the generator mode that creates a PCAP file with a specified amount of packets and name. Those packets have two layers IP and ICMP (Echo request).

For the flood mode, using TCPReplay, we will send the list of packets included on the PCAP file in a loop of _n_ iterations. It's recommended to add 200 packets to the file for DOS Attack and 100 packets to generate latency increase but that varies between networks and AP's.

## Fuzzing function

The fuzzing function will generate a number of random packets with UDP, TCP or ICMP layer as indicated by the user, _n_ times (number of generations parameter). After sending the packet it will wait for a response one second, if there is no response then a default packet will be created. All packets will be stored in a PCAP afterwards, where the first packet is the sent packet and the second one is the response of this packet.  

Also, is obvius that you have to set the target IP because it useless to set it by using Scapy RandIP function.  

## Man-in-the-Middle function

Well, first I want to clarify that it is not a tool designed to attack, it is a tool to check if our network is vulnerable to a mitm scheme attack using ARP Spoofing.  

Using ARP Spoofing we indicate to the router that the victim's IP is in our MAC Address and at the same time we indicate to the victim that the gateway's IP address is in our MAC address so we are intercepting all the traffic between the victim and the router.  

## Special greetings

I'd like to thank the [SUGUS (Free Software Group)](https://sugus.eii.us.es/) of the University of Seville, the [IEEE Seville branch](http://sites.ieee.org/sb-us/) and [Shodan](https://www.shodan.io/) for their help and support.

## Contact information

Please if you have any suggestion about the project feel free to implement it and make a pull request or you can contact me at ffernandezmancera@gmail.com

Thank you for your colaboration.

Happy Hack!  
